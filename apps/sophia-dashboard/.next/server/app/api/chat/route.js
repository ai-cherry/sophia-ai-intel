"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/../../node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/../../node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/../../node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_lynnmusil_sophia_ai_intel_1_apps_sophia_dashboard_src_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/chat/route.ts */ \"(rsc)/./src/app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"/Users/lynnmusil/sophia-ai-intel-1/apps/sophia-dashboard/src/app/api/chat/route.ts\",\n    nextConfigOutput,\n    userland: _Users_lynnmusil_sophia_ai_intel_1_apps_sophia_dashboard_src_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vLi4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyLmpzP25hbWU9YXBwJTJGYXBpJTJGY2hhdCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGY2hhdCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmNoYXQlMkZyb3V0ZS50cyZhcHBEaXI9JTJGVXNlcnMlMkZseW5ubXVzaWwlMkZzb3BoaWEtYWktaW50ZWwtMSUyRmFwcHMlMkZzb3BoaWEtZGFzaGJvYXJkJTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmx5bm5tdXNpbCUyRnNvcGhpYS1haS1pbnRlbC0xJTJGYXBwcyUyRnNvcGhpYS1kYXNoYm9hcmQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9c3RhbmRhbG9uZSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNrQztBQUMvRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NvcGhpYS1kYXNoYm9hcmQvP2YwOTUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2x5bm5tdXNpbC9zb3BoaWEtYWktaW50ZWwtMS9hcHBzL3NvcGhpYS1kYXNoYm9hcmQvc3JjL2FwcC9hcGkvY2hhdC9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJzdGFuZGFsb25lXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NoYXQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jaGF0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jaGF0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2x5bm5tdXNpbC9zb3BoaWEtYWktaW50ZWwtMS9hcHBzL3NvcGhpYS1kYXNoYm9hcmQvc3JjL2FwcC9hcGkvY2hhdC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2hhdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/chat/route.ts":
/*!***********************************!*\
  !*** ./src/app/api/chat/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var _unified_route__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./unified-route */ \"(rsc)/./src/app/api/chat/unified-route.ts\");\n// Import unified handler\n\nasync function POST(request) {\n    // Use unified chat handler for ONE FUCKING CHAT BOX\n    return (0,_unified_route__WEBPACK_IMPORTED_MODULE_0__.POST)(request);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9jaGF0L3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBRUEseUJBQXlCO0FBQzZCO0FBRS9DLGVBQWVBLEtBQUtFLE9BQWdCO0lBQ3pDLG9EQUFvRDtJQUNwRCxPQUFPRCxvREFBV0EsQ0FBQ0M7QUFDckIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zb3BoaWEtZGFzaGJvYXJkLy4vc3JjL2FwcC9hcGkvY2hhdC9yb3V0ZS50cz80NmI3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcblxuLy8gSW1wb3J0IHVuaWZpZWQgaGFuZGxlclxuaW1wb3J0IHsgUE9TVCBhcyB1bmlmaWVkUG9zdCB9IGZyb20gJy4vdW5pZmllZC1yb3V0ZSc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgLy8gVXNlIHVuaWZpZWQgY2hhdCBoYW5kbGVyIGZvciBPTkUgRlVDS0lORyBDSEFUIEJPWFxuICByZXR1cm4gdW5pZmllZFBvc3QocmVxdWVzdCk7XG59XG4iXSwibmFtZXMiOlsiUE9TVCIsInVuaWZpZWRQb3N0IiwicmVxdWVzdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/app/api/chat/unified-route.ts":
/*!*******************************************!*\
  !*** ./src/app/api/chat/unified-route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/../../node_modules/next/dist/api/server.js\");\n/**\n * UNIFIED CHAT API - ONE FUCKING CHAT BOX\n * All requests go through Sophia, she routes internally\n */ \n// Intent detection - what does the user want?\nfunction detectIntent(message) {\n    const msg = message.toLowerCase();\n    // Check for complex multi-stage requests (swarm-of-swarms)\n    if ((msg.includes(\"build\") || msg.includes(\"create\") || msg.includes(\"implement\")) && (msg.includes(\"feature\") || msg.includes(\"app\") || msg.includes(\"system\"))) {\n        return \"swarm-of-swarms\";\n    }\n    if (msg.includes(\"research\") || msg.includes(\"search\") || msg.includes(\"find\")) {\n        return \"research\";\n    }\n    if (msg.includes(\"deploy\") || msg.includes(\"agent\") || msg.includes(\"swarm\")) {\n        return \"agents\";\n    }\n    if (msg.includes(\"code\") || msg.includes(\"generate\") || msg.includes(\"implement\")) {\n        return \"code\";\n    }\n    if (msg.includes(\"plan\") || msg.includes(\"strategy\") || msg.includes(\"design\")) {\n        return \"planning\";\n    }\n    if (msg.includes(\"commit\") || msg.includes(\"push\") || msg.includes(\"github\") || msg.includes(\"pr\") || msg.includes(\"pull request\") || msg.includes(\"merge\")) {\n        return \"github\";\n    }\n    if (msg.includes(\"health\") || msg.includes(\"status\") || msg.includes(\"broken\")) {\n        return \"health\";\n    }\n    if (msg.includes(\"analyze\") || msg.includes(\"review\") || msg.includes(\"repository\")) {\n        return \"analysis\";\n    }\n    return \"general\";\n}\n// Route to appropriate service based on intent\nasync function routeToService(intent, message, context) {\n    const sections = {};\n    switch(intent){\n        case \"research\":\n            // Try multiple research services in priority order\n            let researchHandled = false;\n            // 1. Try MCP Research service first\n            try {\n                const mcpRes = await fetch(\"http://localhost:8085/research\", {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        query: message\n                    }),\n                    signal: AbortSignal.timeout(3000)\n                });\n                if (mcpRes.ok) {\n                    const data = await mcpRes.json();\n                    sections.research = data.results || [\n                        {\n                            status: \"completed\",\n                            data: data\n                        }\n                    ];\n                    sections.actions = [\n                        {\n                            type: \"research.mcp\",\n                            status: \"completed\"\n                        }\n                    ];\n                    researchHandled = true;\n                }\n            } catch (e) {\n                console.log(\"MCP research unavailable, trying swarm...\");\n            }\n            // 2. Fallback to research swarm\n            if (!researchHandled) {\n                try {\n                    const res = await fetch(\"http://localhost:8100/swarms/create\", {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\"\n                        },\n                        body: JSON.stringify({\n                            swarm_type: \"research\",\n                            task: message,\n                            context: {\n                                enable_websocket: true\n                            }\n                        })\n                    });\n                    if (res.ok) {\n                        const data = await res.json();\n                        sections.actions = [\n                            {\n                                type: \"research.swarm\",\n                                swarm_id: data.swarm_id\n                            }\n                        ];\n                        sections.research = [\n                            {\n                                status: \"running\",\n                                message: \"Deep web research swarm deployed\"\n                            }\n                        ];\n                        researchHandled = true;\n                    }\n                } catch (e) {\n                    console.error(\"Research swarm error:\", e);\n                }\n            }\n            // 3. Final fallback to direct swarm API\n            if (!researchHandled) {\n                try {\n                    const directRes = await fetch(\"http://localhost:8200/chat\", {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\"\n                        },\n                        body: JSON.stringify({\n                            message: message,\n                            agent_type: \"research\"\n                        })\n                    });\n                    if (directRes.ok) {\n                        const data = await directRes.json();\n                        sections.research = [\n                            {\n                                status: \"completed\",\n                                data: data.response\n                            }\n                        ];\n                        sections.actions = [\n                            {\n                                type: \"research.direct\",\n                                task_id: data.task_id\n                            }\n                        ];\n                    }\n                } catch (e) {\n                    sections.research = [\n                        {\n                            status: \"error\",\n                            message: \"All research services unavailable\"\n                        }\n                    ];\n                }\n            }\n            break;\n        case \"agents\":\n            // Deploy/manage agents with real swarm executor\n            let agentHandled = false;\n            // 1. Try real swarm executor first\n            try {\n                const executorRes = await fetch(\"http://localhost:8088/deploy\", {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        task: message,\n                        config: {\n                            enable_memory: true,\n                            enable_websocket: true,\n                            models: [\n                                \"gpt-4-turbo-preview\",\n                                \"claude-3-opus\"\n                            ]\n                        }\n                    }),\n                    signal: AbortSignal.timeout(5000)\n                });\n                if (executorRes.ok) {\n                    const data = await executorRes.json();\n                    sections.actions = [\n                        {\n                            type: \"agent.executor\",\n                            swarm_id: data.swarm_id\n                        }\n                    ];\n                    sections.events = [\n                        {\n                            type: \"swarm_deployed\",\n                            id: data.swarm_id,\n                            agents: data.agents\n                        }\n                    ];\n                    agentHandled = true;\n                }\n            } catch (e) {\n                console.log(\"Real swarm executor unavailable, trying unified swarm...\");\n            }\n            // 2. Fallback to unified swarm service\n            if (!agentHandled) {\n                try {\n                    const res = await fetch(\"http://localhost:8100/swarms/create\", {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\"\n                        },\n                        body: JSON.stringify({\n                            swarm_type: \"analysis\",\n                            task: message,\n                            context: {\n                                enable_websocket: true\n                            }\n                        })\n                    });\n                    if (res.ok) {\n                        const data = await res.json();\n                        sections.actions = [\n                            {\n                                type: \"agent.unified\",\n                                swarm_id: data.swarm_id\n                            }\n                        ];\n                        sections.events = [\n                            {\n                                type: \"swarm_created\",\n                                id: data.swarm_id\n                            }\n                        ];\n                        agentHandled = true;\n                    }\n                } catch (e) {\n                    console.error(\"Unified swarm error:\", e);\n                }\n            }\n            // 3. WebSocket notification for real-time updates\n            if (agentHandled && sections.events && sections.events[0]) {\n                try {\n                    await fetch(\"http://localhost:8096/notify\", {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\"\n                        },\n                        body: JSON.stringify({\n                            type: \"swarm.deployed\",\n                            data: sections.events[0]\n                        })\n                    });\n                } catch (e) {\n                    console.log(\"WebSocket notification failed\");\n                }\n            }\n            break;\n        case \"planning\":\n            // Generate plans\n            try {\n                const res = await fetch(\"http://localhost:8100/plans\", {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        task: message\n                    })\n                });\n                if (res.ok) {\n                    const data = await res.json();\n                    sections.plans = data.plans;\n                    sections.actions = [\n                        {\n                            type: \"plans.generated\",\n                            count: 3\n                        }\n                    ];\n                }\n            } catch (e) {\n                console.error(\"Planning error:\", e);\n            }\n            break;\n        case \"code\":\n            // Generate code\n            try {\n                const res = await fetch(\"http://localhost:8100/swarms/create\", {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        swarm_type: \"coding\",\n                        task: message,\n                        context: {}\n                    })\n                });\n                if (res.ok) {\n                    const data = await res.json();\n                    sections.actions = [\n                        {\n                            type: \"code.generating\",\n                            swarm_id: data.swarm_id\n                        }\n                    ];\n                    sections.code = {\n                        status: \"generating\",\n                        language: \"python\"\n                    };\n                }\n            } catch (e) {\n                console.error(\"Code generation error:\", e);\n            }\n            break;\n        case \"swarm-of-swarms\":\n            // Execute full 6-stage pipeline\n            try {\n                // Stage 1: Strategy\n                const strategyRes = await fetch(\"http://localhost:8100/plans\", {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        task: message\n                    })\n                });\n                if (strategyRes.ok) {\n                    const strategy = await strategyRes.json();\n                    // Stage 2: Deep Research\n                    const researchRes = await fetch(\"http://localhost:8100/swarms/create\", {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\"\n                        },\n                        body: JSON.stringify({\n                            swarm_type: \"research\",\n                            task: `Research requirements for: ${message}`,\n                            context: {\n                                strategy: strategy.plans\n                            }\n                        })\n                    });\n                    // Stage 3: Planning\n                    const planRes = await fetch(\"http://localhost:8100/swarms/create\", {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\"\n                        },\n                        body: JSON.stringify({\n                            swarm_type: \"planning\",\n                            task: `Create implementation plan for: ${message}`,\n                            context: {\n                                strategy: strategy.plans\n                            }\n                        })\n                    });\n                    // Stage 4: Coding\n                    const codeRes = await fetch(\"http://localhost:8100/swarms/create\", {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\"\n                        },\n                        body: JSON.stringify({\n                            swarm_type: \"coding\",\n                            task: message,\n                            context: {\n                                plan: planRes.ok ? await planRes.json() : null\n                            }\n                        })\n                    });\n                    sections.actions = [\n                        {\n                            type: \"swarm-of-swarms.initiated\",\n                            stages: 6\n                        },\n                        {\n                            type: \"strategy.completed\"\n                        },\n                        {\n                            type: \"research.started\"\n                        },\n                        {\n                            type: \"planning.started\"\n                        },\n                        {\n                            type: \"coding.started\"\n                        }\n                    ];\n                    sections.events = [\n                        {\n                            type: \"pipeline.started\",\n                            task: message,\n                            stages: [\n                                \"strategy\",\n                                \"research\",\n                                \"planning\",\n                                \"coding\",\n                                \"qc\",\n                                \"deploy\"\n                            ]\n                        }\n                    ];\n                    sections.summary = \"Full development pipeline initiated. All 6 stages are now executing.\";\n                }\n            } catch (e) {\n                console.error(\"Swarm-of-swarms error:\", e);\n                sections.summary = \"Pipeline initialization failed, falling back to individual services\";\n            }\n            break;\n        case \"github\":\n            // GitHub operations with MCP\n            try {\n                // Detect specific GitHub operation\n                const isCommit = message.includes(\"commit\");\n                const isPR = message.includes(\"pr\") || message.includes(\"pull request\");\n                const isPush = message.includes(\"push\");\n                if (isCommit || isPR || isPush) {\n                    // Use GitHub MCP service\n                    const githubRes = await fetch(\"http://localhost:8082/github/operation\", {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\"\n                        },\n                        body: JSON.stringify({\n                            operation: isCommit ? \"commit\" : isPR ? \"create_pr\" : \"push\",\n                            message: message,\n                            context: context\n                        })\n                    });\n                    if (githubRes.ok) {\n                        const data = await githubRes.json();\n                        sections.github = {\n                            status: \"completed\",\n                            operation: data.operation,\n                            result: data.result\n                        };\n                        sections.actions = [\n                            {\n                                type: `github.${data.operation}`,\n                                status: \"completed\"\n                            }\n                        ];\n                    }\n                } else {\n                    // General GitHub query\n                    sections.github = {\n                        status: \"analyzing\",\n                        message: \"Analyzing GitHub request...\"\n                    };\n                    sections.actions = [\n                        {\n                            type: \"github.query\",\n                            status: \"processing\"\n                        }\n                    ];\n                }\n            } catch (e) {\n                console.error(\"GitHub operation error:\", e);\n                sections.github = {\n                    status: \"error\",\n                    message: \"GitHub service unavailable\"\n                };\n            }\n            break;\n        case \"health\":\n            // Check service health\n            const healthChecks = await checkServiceHealth();\n            sections.actions = [\n                {\n                    type: \"health.checked\",\n                    services: healthChecks.length\n                }\n            ];\n            sections.summary = `${healthChecks.filter((h)=>h.status === \"healthy\").length}/${healthChecks.length} services healthy`;\n            break;\n        default:\n            // General response\n            sections.summary = \"Processing your request...\";\n    }\n    return sections;\n}\n// Check real service health\nasync function checkServiceHealth() {\n    const services = [\n        {\n            name: \"unified-swarm\",\n            url: \"http://localhost:8100/health\"\n        },\n        {\n            name: \"mcp-context\",\n            url: \"http://localhost:8081/healthz\"\n        },\n        {\n            name: \"mcp-github\",\n            url: \"http://localhost:8082/health\"\n        },\n        {\n            name: \"mcp-research\",\n            url: \"http://localhost:8085/health\"\n        }\n    ];\n    const results = await Promise.all(services.map(async (service)=>{\n        try {\n            const res = await fetch(service.url, {\n                signal: AbortSignal.timeout(1000)\n            });\n            return {\n                ...service,\n                status: res.ok ? \"healthy\" : \"unhealthy\",\n                latency: 0\n            };\n        } catch  {\n            return {\n                ...service,\n                status: \"dead\",\n                latency: -1\n            };\n        }\n    }));\n    return results;\n}\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const messages = body.messages || [\n            {\n                content: body.message || \"\"\n            }\n        ];\n        const message = messages[messages.length - 1]?.content || \"\";\n        const context = body.context || {};\n        // Detect intent from message\n        const intent = detectIntent(message);\n        // Route to appropriate service\n        const sections = await routeToService(intent, message, context);\n        // Build unified response with sections format expected by audit\n        const response = {\n            sections: {\n                summary: sections.summary || `I'm processing your ${intent} request...`,\n                actions: sections.actions || [],\n                research: sections.research || [],\n                plans: sections.plans || null,\n                code: sections.code || null,\n                github: sections.github || null,\n                events: sections.events || []\n            },\n            metadata: {\n                intent,\n                timestamp: new Date().toISOString(),\n                sessionId: context?.sessionId || `session_${Date.now()}`\n            }\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response);\n    } catch (error) {\n        console.error(\"Chat API Error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            sections: {\n                summary: \"Error processing request\",\n                actions: [],\n                error: error instanceof Error ? error.message : \"Unknown error\"\n            }\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9jaGF0L3VuaWZpZWQtcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTs7O0NBR0MsR0FFMEM7QUFZM0MsOENBQThDO0FBQzlDLFNBQVNDLGFBQWFDLE9BQWU7SUFDbkMsTUFBTUMsTUFBTUQsUUFBUUUsV0FBVztJQUUvQiwyREFBMkQ7SUFDM0QsSUFBSSxDQUFDRCxJQUFJRSxRQUFRLENBQUMsWUFBWUYsSUFBSUUsUUFBUSxDQUFDLGFBQWFGLElBQUlFLFFBQVEsQ0FBQyxZQUFXLEtBQzNFRixDQUFBQSxJQUFJRSxRQUFRLENBQUMsY0FBY0YsSUFBSUUsUUFBUSxDQUFDLFVBQVVGLElBQUlFLFFBQVEsQ0FBQyxTQUFRLEdBQUk7UUFDOUUsT0FBTztJQUNUO0lBRUEsSUFBSUYsSUFBSUUsUUFBUSxDQUFDLGVBQWVGLElBQUlFLFFBQVEsQ0FBQyxhQUFhRixJQUFJRSxRQUFRLENBQUMsU0FBUztRQUM5RSxPQUFPO0lBQ1Q7SUFDQSxJQUFJRixJQUFJRSxRQUFRLENBQUMsYUFBYUYsSUFBSUUsUUFBUSxDQUFDLFlBQVlGLElBQUlFLFFBQVEsQ0FBQyxVQUFVO1FBQzVFLE9BQU87SUFDVDtJQUNBLElBQUlGLElBQUlFLFFBQVEsQ0FBQyxXQUFXRixJQUFJRSxRQUFRLENBQUMsZUFBZUYsSUFBSUUsUUFBUSxDQUFDLGNBQWM7UUFDakYsT0FBTztJQUNUO0lBQ0EsSUFBSUYsSUFBSUUsUUFBUSxDQUFDLFdBQVdGLElBQUlFLFFBQVEsQ0FBQyxlQUFlRixJQUFJRSxRQUFRLENBQUMsV0FBVztRQUM5RSxPQUFPO0lBQ1Q7SUFDQSxJQUFJRixJQUFJRSxRQUFRLENBQUMsYUFBYUYsSUFBSUUsUUFBUSxDQUFDLFdBQVdGLElBQUlFLFFBQVEsQ0FBQyxhQUMvREYsSUFBSUUsUUFBUSxDQUFDLFNBQVNGLElBQUlFLFFBQVEsQ0FBQyxtQkFBbUJGLElBQUlFLFFBQVEsQ0FBQyxVQUFVO1FBQy9FLE9BQU87SUFDVDtJQUNBLElBQUlGLElB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U0FBUzJELE1BQU0sSUFBSTtnQkFDM0JwQixRQUFRdkMsU0FBU3VDLE1BQU0sSUFBSSxFQUFFO1lBQy9CO1lBQ0F1QyxVQUFVO2dCQUNSaEY7Z0JBQ0FpRixXQUFXLElBQUlDLE9BQU9DLFdBQVc7Z0JBQ2pDQyxXQUFXbkYsU0FBU21GLGFBQWEsQ0FBQyxRQUFRLEVBQUVGLEtBQUtHLEdBQUcsR0FBRyxDQUFDO1lBQzFEO1FBQ0Y7UUFFQSxPQUFPNUYscURBQVlBLENBQUN3QixJQUFJLENBQUNpQjtJQUUzQixFQUFFLE9BQU9ILE9BQU87UUFDZFAsUUFBUU8sS0FBSyxDQUFDLG1CQUFtQkE7UUFDakMsT0FBT3RDLHFEQUFZQSxDQUFDd0IsSUFBSSxDQUFDO1lBQ3ZCZixVQUFVO2dCQUNScUQsU0FBUztnQkFDVGxDLFNBQVMsRUFBRTtnQkFDWFUsT0FBT0EsaUJBQWlCdUQsUUFBUXZELE1BQU1wQyxPQUFPLEdBQUc7WUFDbEQ7UUFDRixHQUFHO1lBQUV5QixRQUFRO1FBQUk7SUFDbkI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NvcGhpYS1kYXNoYm9hcmQvLi9zcmMvYXBwL2FwaS9jaGF0L3VuaWZpZWQtcm91dGUudHM/NTdjZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFVOSUZJRUQgQ0hBVCBBUEkgLSBPTkUgRlVDS0lORyBDSEFUIEJPWFxuICogQWxsIHJlcXVlc3RzIGdvIHRocm91Z2ggU29waGlhLCBzaGUgcm91dGVzIGludGVybmFsbHlcbiAqL1xuXG5pbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5cbmludGVyZmFjZSBDaGF0U2VjdGlvbiB7XG4gIHN1bW1hcnk/OiBzdHJpbmc7XG4gIGFjdGlvbnM/OiBhbnlbXTtcbiAgcmVzZWFyY2g/OiBhbnlbXTtcbiAgcGxhbnM/OiBhbnk7XG4gIGNvZGU/OiBhbnk7XG4gIGdpdGh1Yj86IGFueTtcbiAgZXZlbnRzPzogYW55W107XG59XG5cbi8vIEludGVudCBkZXRlY3Rpb24gLSB3aGF0IGRvZXMgdGhlIHVzZXIgd2FudD9cbmZ1bmN0aW9uIGRldGVjdEludGVudChtZXNzYWdlOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCBtc2cgPSBtZXNzYWdlLnRvTG93ZXJDYXNlKCk7XG4gIFxuICAvLyBDaGVjayBmb3IgY29tcGxleCBtdWx0aS1zdGFnZSByZXF1ZXN0cyAoc3dhcm0tb2Ytc3dhcm1zKVxuICBpZiAoKG1zZy5pbmNsdWRlcygnYnVpbGQnKSB8fCBtc2cuaW5jbHVkZXMoJ2NyZWF0ZScpIHx8IG1zZy5pbmNsdWRlcygnaW1wbGVtZW50JykpICYmXG4gICAgICAobXNnLmluY2x1ZGVzKCdmZWF0dXJlJykgfHwgbXNnLmluY2x1ZGVzKCdhcHAnKSB8fCBtc2cuaW5jbHVkZXMoJ3N5c3RlbScpKSkge1xuICAgIHJldHVybiAnc3dhcm0tb2Ytc3dhcm1zJztcbiAgfVxuICBcbiAgaWYgKG1zZy5pbmNsdWRlcygncmVzZWFyY2gnKSB8fCBtc2cuaW5jbHVkZXMoJ3NlYXJjaCcpIHx8IG1zZy5pbmNsdWRlcygnZmluZCcpKSB7XG4gICAgcmV0dXJuICdyZXNlYXJjaCc7XG4gIH1cbiAgaWYgKG1zZy5pbmNsdWRlcygnZGVwbG95JykgfHwgbXNnLmluY2x1ZGVzKCdhZ2VudCcpIHx8IG1zZy5pbmNsdWRlcygnc3dhcm0nKSkge1xuICAgIHJldHVybiAnYWdlbnRzJztcbiAgfVxuICBpZiAobXNnLmluY2x1ZGVzKCdjb2RlJykgfHwgbXNnLmluY2x1ZGVzKCdnZW5lcmF0ZScpIHx8IG1zZy5pbmNsdWRlcygnaW1wbGVtZW50JykpIHtcbiAgICByZXR1cm4gJ2NvZGUnO1xuICB9XG4gIGlmIChtc2cuaW5jbHVkZXMoJ3BsYW4nKSB8fCBtc2cuaW5jbHVkZXMoJ3N0cmF0ZWd5JykgfHwgbXNnLmluY2x1ZGVzKCdkZXNpZ24nKSkge1xuICAgIHJldHVybiAncGxhbm5pbmcnO1xuICB9XG4gIGlmIChtc2cuaW5jbHVkZXMoJ2NvbW1pdCcpIHx8IG1zZy5pbmNsdWRlcygncHVzaCcpIHx8IG1zZy5pbmNsdWRlcygnZ2l0aHViJykgfHwgXG4gICAgICBtc2cuaW5jbHVkZXMoJ3ByJykgfHwgbXNnLmluY2x1ZGVzKCdwdWxsIHJlcXVlc3QnKSB8fCBtc2cuaW5jbHVkZXMoJ21lcmdlJykpIHtcbiAgICByZXR1cm4gJ2dpdGh1Yic7XG4gIH1cbiAgaWYgKG1zZy5pbmNsdWRlcygnaGVhbHRoJykgfHwgbXNnLmluY2x1ZGVzKCdzdGF0dXMnKSB8fCBtc2cuaW5jbHVkZXMoJ2Jyb2tlbicpKSB7XG4gICAgcmV0dXJuICdoZWFsdGgnO1xuICB9XG4gIGlmIChtc2cuaW5jbHVkZXMoJ2FuYWx5emUnKSB8fCBtc2cuaW5jbHVkZXMoJ3JldmlldycpIHx8IG1zZy5pbmNsdWRlcygncmVwb3NpdG9yeScpKSB7XG4gICAgcmV0dXJuICdhbmFseXNpcyc7XG4gIH1cbiAgXG4gIHJldHVybiAnZ2VuZXJhbCc7XG59XG5cbi8vIFJvdXRlIHRvIGFwcHJvcHJpYXRlIHNlcnZpY2UgYmFzZWQgb24gaW50ZW50XG5hc3luYyBmdW5jdGlvbiByb3V0ZVRvU2VydmljZShpbnRlbnQ6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nLCBjb250ZXh0OiBhbnkpOiBQcm9taXNlPENoYXRTZWN0aW9uPiB7XG4gIGNvbnN0IHNlY3Rpb25zOiBDaGF0U2VjdGlvbiA9IHt9O1xuICBcbiAgc3dpdGNoIChpbnRlbnQpIHtcbiAgICBjYXNlICdyZXNlYXJjaCc6XG4gICAgICAvLyBUcnkgbXVsdGlwbGUgcmVzZWFyY2ggc2VydmljZXMgaW4gcHJpb3JpdHkgb3JkZXJcbiAgICAgIGxldCByZXNlYXJjaEhhbmRsZWQgPSBmYWxzZTtcbiAgICAgIFxuICAgICAgLy8gMS4gVHJ5IE1DUCBSZXNlYXJjaCBzZXJ2aWNlIGZpcnN0XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBtY3BSZXMgPSBhd2FpdCBmZXRjaCgnaHR0cDovL2xvY2FsaG9zdDo4MDg1L3Jlc2VhcmNoJywge1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgcXVlcnk6IG1lc3NhZ2UgfSksXG4gICAgICAgICAgc2lnbmFsOiBBYm9ydFNpZ25hbC50aW1lb3V0KDMwMDApXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKG1jcFJlcy5vaykge1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBtY3BSZXMuanNvbigpO1xuICAgICAgICAgIHNlY3Rpb25zLnJlc2VhcmNoID0gZGF0YS5yZXN1bHRzIHx8IFt7IHN0YXR1czogJ2NvbXBsZXRlZCcsIGRhdGE6IGRhdGEgfV07XG4gICAgICAgICAgc2VjdGlvbnMuYWN0aW9ucyA9IFt7IHR5cGU6ICdyZXNlYXJjaC5tY3AnLCBzdGF0dXM6ICdjb21wbGV0ZWQnIH1dO1xuICAgICAgICAgIHJlc2VhcmNoSGFuZGxlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ01DUCByZXNlYXJjaCB1bmF2YWlsYWJsZSwgdHJ5aW5nIHN3YXJtLi4uJyk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIDIuIEZhbGxiYWNrIHRvIHJlc2VhcmNoIHN3YXJtXG4gICAgICBpZiAoIXJlc2VhcmNoSGFuZGxlZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjgxMDAvc3dhcm1zL2NyZWF0ZScsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgIHN3YXJtX3R5cGU6ICdyZXNlYXJjaCcsXG4gICAgICAgICAgICAgIHRhc2s6IG1lc3NhZ2UsXG4gICAgICAgICAgICAgIGNvbnRleHQ6IHsgZW5hYmxlX3dlYnNvY2tldDogdHJ1ZSB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgICAgICAgc2VjdGlvbnMuYWN0aW9ucyA9IFt7IHR5cGU6ICdyZXNlYXJjaC5zd2FybScsIHN3YXJtX2lkOiBkYXRhLnN3YXJtX2lkIH1dO1xuICAgICAgICAgICAgc2VjdGlvbnMucmVzZWFyY2ggPSBbeyBzdGF0dXM6ICdydW5uaW5nJywgbWVzc2FnZTogJ0RlZXAgd2ViIHJlc2VhcmNoIHN3YXJtIGRlcGxveWVkJyB9XTtcbiAgICAgICAgICAgIHJlc2VhcmNoSGFuZGxlZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignUmVzZWFyY2ggc3dhcm0gZXJyb3I6JywgZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gMy4gRmluYWwgZmFsbGJhY2sgdG8gZGlyZWN0IHN3YXJtIEFQSVxuICAgICAgaWYgKCFyZXNlYXJjaEhhbmRsZWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBkaXJlY3RSZXMgPSBhd2FpdCBmZXRjaCgnaHR0cDovL2xvY2FsaG9zdDo4MjAwL2NoYXQnLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICAgICAgICBhZ2VudF90eXBlOiAncmVzZWFyY2gnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChkaXJlY3RSZXMub2spIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBkaXJlY3RSZXMuanNvbigpO1xuICAgICAgICAgICAgc2VjdGlvbnMucmVzZWFyY2ggPSBbeyBzdGF0dXM6ICdjb21wbGV0ZWQnLCBkYXRhOiBkYXRhLnJlc3BvbnNlIH1dO1xuICAgICAgICAgICAgc2VjdGlvbnMuYWN0aW9ucyA9IFt7IHR5cGU6ICdyZXNlYXJjaC5kaXJlY3QnLCB0YXNrX2lkOiBkYXRhLnRhc2tfaWQgfV07XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgc2VjdGlvbnMucmVzZWFyY2ggPSBbeyBzdGF0dXM6ICdlcnJvcicsIG1lc3NhZ2U6ICdBbGwgcmVzZWFyY2ggc2VydmljZXMgdW5hdmFpbGFibGUnIH1dO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICAgIFxuICAgIGNhc2UgJ2FnZW50cyc6XG4gICAgICAvLyBEZXBsb3kvbWFuYWdlIGFnZW50cyB3aXRoIHJlYWwgc3dhcm0gZXhlY3V0b3JcbiAgICAgIGxldCBhZ2VudEhhbmRsZWQgPSBmYWxzZTtcbiAgICAgIFxuICAgICAgLy8gMS4gVHJ5IHJlYWwgc3dhcm0gZXhlY3V0b3IgZmlyc3RcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGV4ZWN1dG9yUmVzID0gYXdhaXQgZmV0Y2goJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9kZXBsb3knLCB7XG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgdGFzazogbWVzc2FnZSxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICBlbmFibGVfbWVtb3J5OiB0cnVlLFxuICAgICAgICAgICAgICBlbmFibGVfd2Vic29ja2V0OiB0cnVlLFxuICAgICAgICAgICAgICBtb2RlbHM6IFsnZ3B0LTQtdHVyYm8tcHJldmlldycsICdjbGF1ZGUtMy1vcHVzJ11cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSxcbiAgICAgICAgICBzaWduYWw6IEFib3J0U2lnbmFsLnRpbWVvdXQoNTAwMClcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZXhlY3V0b3JSZXMub2spIHtcbiAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgZXhlY3V0b3JSZXMuanNvbigpO1xuICAgICAgICAgIHNlY3Rpb25zLmFjdGlvbnMgPSBbeyB0eXBlOiAnYWdlbnQuZXhlY3V0b3InLCBzd2FybV9pZDogZGF0YS5zd2FybV9pZCB9XTtcbiAgICAgICAgICBzZWN0aW9ucy5ldmVudHMgPSBbeyB0eXBlOiAnc3dhcm1fZGVwbG95ZWQnLCBpZDogZGF0YS5zd2FybV9pZCwgYWdlbnRzOiBkYXRhLmFnZW50cyB9XTtcbiAgICAgICAgICBhZ2VudEhhbmRsZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdSZWFsIHN3YXJtIGV4ZWN1dG9yIHVuYXZhaWxhYmxlLCB0cnlpbmcgdW5pZmllZCBzd2FybS4uLicpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyAyLiBGYWxsYmFjayB0byB1bmlmaWVkIHN3YXJtIHNlcnZpY2VcbiAgICAgIGlmICghYWdlbnRIYW5kbGVkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goJ2h0dHA6Ly9sb2NhbGhvc3Q6ODEwMC9zd2FybXMvY3JlYXRlJywge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgc3dhcm1fdHlwZTogJ2FuYWx5c2lzJyxcbiAgICAgICAgICAgICAgdGFzazogbWVzc2FnZSxcbiAgICAgICAgICAgICAgY29udGV4dDogeyBlbmFibGVfd2Vic29ja2V0OiB0cnVlIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgICAgICAgICBzZWN0aW9ucy5hY3Rpb25zID0gW3sgdHlwZTogJ2FnZW50LnVuaWZpZWQnLCBzd2FybV9pZDogZGF0YS5zd2FybV9pZCB9XTtcbiAgICAgICAgICAgIHNlY3Rpb25zLmV2ZW50cyA9IFt7IHR5cGU6ICdzd2FybV9jcmVhdGVkJywgaWQ6IGRhdGEuc3dhcm1faWQgfV07XG4gICAgICAgICAgICBhZ2VudEhhbmRsZWQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuaWZpZWQgc3dhcm0gZXJyb3I6JywgZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gMy4gV2ViU29ja2V0IG5vdGlmaWNhdGlvbiBmb3IgcmVhbC10aW1lIHVwZGF0ZXNcbiAgICAgIGlmIChhZ2VudEhhbmRsZWQgJiYgc2VjdGlvbnMuZXZlbnRzICYmIHNlY3Rpb25zLmV2ZW50c1swXSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjgwOTYvbm90aWZ5Jywge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgdHlwZTogJ3N3YXJtLmRlcGxveWVkJyxcbiAgICAgICAgICAgICAgZGF0YTogc2VjdGlvbnMuZXZlbnRzWzBdXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1dlYlNvY2tldCBub3RpZmljYXRpb24gZmFpbGVkJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgICAgXG4gICAgY2FzZSAncGxhbm5pbmcnOlxuICAgICAgLy8gR2VuZXJhdGUgcGxhbnNcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjgxMDAvcGxhbnMnLCB7XG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyB0YXNrOiBtZXNzYWdlIH0pXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgICAgIHNlY3Rpb25zLnBsYW5zID0gZGF0YS5wbGFucztcbiAgICAgICAgICBzZWN0aW9ucy5hY3Rpb25zID0gW3sgdHlwZTogJ3BsYW5zLmdlbmVyYXRlZCcsIGNvdW50OiAzIH1dO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1BsYW5uaW5nIGVycm9yOicsIGUpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgICBcbiAgICBjYXNlICdjb2RlJzpcbiAgICAgIC8vIEdlbmVyYXRlIGNvZGVcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjgxMDAvc3dhcm1zL2NyZWF0ZScsIHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBzd2FybV90eXBlOiAnY29kaW5nJyxcbiAgICAgICAgICAgIHRhc2s6IG1lc3NhZ2UsXG4gICAgICAgICAgICBjb250ZXh0OiB7fVxuICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgICAgIHNlY3Rpb25zLmFjdGlvbnMgPSBbeyB0eXBlOiAnY29kZS5nZW5lcmF0aW5nJywgc3dhcm1faWQ6IGRhdGEuc3dhcm1faWQgfV07XG4gICAgICAgICAgc2VjdGlvbnMuY29kZSA9IHsgc3RhdHVzOiAnZ2VuZXJhdGluZycsIGxhbmd1YWdlOiAncHl0aG9uJyB9O1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NvZGUgZ2VuZXJhdGlvbiBlcnJvcjonLCBlKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgICAgXG4gICAgY2FzZSAnc3dhcm0tb2Ytc3dhcm1zJzpcbiAgICAgIC8vIEV4ZWN1dGUgZnVsbCA2LXN0YWdlIHBpcGVsaW5lXG4gICAgICB0cnkge1xuICAgICAgICAvLyBTdGFnZSAxOiBTdHJhdGVneVxuICAgICAgICBjb25zdCBzdHJhdGVneVJlcyA9IGF3YWl0IGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjgxMDAvcGxhbnMnLCB7XG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyB0YXNrOiBtZXNzYWdlIH0pXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKHN0cmF0ZWd5UmVzLm9rKSB7XG4gICAgICAgICAgY29uc3Qgc3RyYXRlZ3kgPSBhd2FpdCBzdHJhdGVneVJlcy5qc29uKCk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gU3RhZ2UgMjogRGVlcCBSZXNlYXJjaFxuICAgICAgICAgIGNvbnN0IHJlc2VhcmNoUmVzID0gYXdhaXQgZmV0Y2goJ2h0dHA6Ly9sb2NhbGhvc3Q6ODEwMC9zd2FybXMvY3JlYXRlJywge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgc3dhcm1fdHlwZTogJ3Jlc2VhcmNoJyxcbiAgICAgICAgICAgICAgdGFzazogYFJlc2VhcmNoIHJlcXVpcmVtZW50cyBmb3I6ICR7bWVzc2FnZX1gLFxuICAgICAgICAgICAgICBjb250ZXh0OiB7IHN0cmF0ZWd5OiBzdHJhdGVneS5wbGFucyB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFN0YWdlIDM6IFBsYW5uaW5nXG4gICAgICAgICAgY29uc3QgcGxhblJlcyA9IGF3YWl0IGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjgxMDAvc3dhcm1zL2NyZWF0ZScsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgIHN3YXJtX3R5cGU6ICdwbGFubmluZycsXG4gICAgICAgICAgICAgIHRhc2s6IGBDcmVhdGUgaW1wbGVtZW50YXRpb24gcGxhbiBmb3I6ICR7bWVzc2FnZX1gLFxuICAgICAgICAgICAgICBjb250ZXh0OiB7IHN0cmF0ZWd5OiBzdHJhdGVneS5wbGFucyB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFN0YWdlIDQ6IENvZGluZ1xuICAgICAgICAgIGNvbnN0IGNvZGVSZXMgPSBhd2FpdCBmZXRjaCgnaHR0cDovL2xvY2FsaG9zdDo4MTAwL3N3YXJtcy9jcmVhdGUnLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICBzd2FybV90eXBlOiAnY29kaW5nJyxcbiAgICAgICAgICAgICAgdGFzazogbWVzc2FnZSxcbiAgICAgICAgICAgICAgY29udGV4dDogeyBwbGFuOiBwbGFuUmVzLm9rID8gYXdhaXQgcGxhblJlcy5qc29uKCkgOiBudWxsIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgc2VjdGlvbnMuYWN0aW9ucyA9IFtcbiAgICAgICAgICAgIHsgdHlwZTogJ3N3YXJtLW9mLXN3YXJtcy5pbml0aWF0ZWQnLCBzdGFnZXM6IDYgfSxcbiAgICAgICAgICAgIHsgdHlwZTogJ3N0cmF0ZWd5LmNvbXBsZXRlZCcgfSxcbiAgICAgICAgICAgIHsgdHlwZTogJ3Jlc2VhcmNoLnN0YXJ0ZWQnIH0sXG4gICAgICAgICAgICB7IHR5cGU6ICdwbGFubmluZy5zdGFydGVkJyB9LFxuICAgICAgICAgICAgeyB0eXBlOiAnY29kaW5nLnN0YXJ0ZWQnIH1cbiAgICAgICAgICBdO1xuICAgICAgICAgIFxuICAgICAgICAgIHNlY3Rpb25zLmV2ZW50cyA9IFtcbiAgICAgICAgICAgIHsgdHlwZTogJ3BpcGVsaW5lLnN0YXJ0ZWQnLCB0YXNrOiBtZXNzYWdlLCBzdGFnZXM6IFsnc3RyYXRlZ3knLCAncmVzZWFyY2gnLCAncGxhbm5pbmcnLCAnY29kaW5nJywgJ3FjJywgJ2RlcGxveSddIH1cbiAgICAgICAgICBdO1xuICAgICAgICAgIFxuICAgICAgICAgIHNlY3Rpb25zLnN1bW1hcnkgPSAnRnVsbCBkZXZlbG9wbWVudCBwaXBlbGluZSBpbml0aWF0ZWQuIEFsbCA2IHN0YWdlcyBhcmUgbm93IGV4ZWN1dGluZy4nO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1N3YXJtLW9mLXN3YXJtcyBlcnJvcjonLCBlKTtcbiAgICAgICAgc2VjdGlvbnMuc3VtbWFyeSA9ICdQaXBlbGluZSBpbml0aWFsaXphdGlvbiBmYWlsZWQsIGZhbGxpbmcgYmFjayB0byBpbmRpdmlkdWFsIHNlcnZpY2VzJztcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIFxuICAgIGNhc2UgJ2dpdGh1Yic6XG4gICAgICAvLyBHaXRIdWIgb3BlcmF0aW9ucyB3aXRoIE1DUFxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gRGV0ZWN0IHNwZWNpZmljIEdpdEh1YiBvcGVyYXRpb25cbiAgICAgICAgY29uc3QgaXNDb21taXQgPSBtZXNzYWdlLmluY2x1ZGVzKCdjb21taXQnKTtcbiAgICAgICAgY29uc3QgaXNQUiA9IG1lc3NhZ2UuaW5jbHVkZXMoJ3ByJykgfHwgbWVzc2FnZS5pbmNsdWRlcygncHVsbCByZXF1ZXN0Jyk7XG4gICAgICAgIGNvbnN0IGlzUHVzaCA9IG1lc3NhZ2UuaW5jbHVkZXMoJ3B1c2gnKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChpc0NvbW1pdCB8fCBpc1BSIHx8IGlzUHVzaCkge1xuICAgICAgICAgIC8vIFVzZSBHaXRIdWIgTUNQIHNlcnZpY2VcbiAgICAgICAgICBjb25zdCBnaXRodWJSZXMgPSBhd2FpdCBmZXRjaCgnaHR0cDovL2xvY2FsaG9zdDo4MDgyL2dpdGh1Yi9vcGVyYXRpb24nLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICBvcGVyYXRpb246IGlzQ29tbWl0ID8gJ2NvbW1pdCcgOiBpc1BSID8gJ2NyZWF0ZV9wcicgOiAncHVzaCcsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgICAgICAgIGNvbnRleHQ6IGNvbnRleHRcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKGdpdGh1YlJlcy5vaykge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGdpdGh1YlJlcy5qc29uKCk7XG4gICAgICAgICAgICBzZWN0aW9ucy5naXRodWIgPSB7IFxuICAgICAgICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLCBcbiAgICAgICAgICAgICAgb3BlcmF0aW9uOiBkYXRhLm9wZXJhdGlvbixcbiAgICAgICAgICAgICAgcmVzdWx0OiBkYXRhLnJlc3VsdCBcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzZWN0aW9ucy5hY3Rpb25zID0gW3sgdHlwZTogYGdpdGh1Yi4ke2RhdGEub3BlcmF0aW9ufWAsIHN0YXR1czogJ2NvbXBsZXRlZCcgfV07XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEdlbmVyYWwgR2l0SHViIHF1ZXJ5XG4gICAgICAgICAgc2VjdGlvbnMuZ2l0aHViID0geyBzdGF0dXM6ICdhbmFseXppbmcnLCBtZXNzYWdlOiAnQW5hbHl6aW5nIEdpdEh1YiByZXF1ZXN0Li4uJyB9O1xuICAgICAgICAgIHNlY3Rpb25zLmFjdGlvbnMgPSBbeyB0eXBlOiAnZ2l0aHViLnF1ZXJ5Jywgc3RhdHVzOiAncHJvY2Vzc2luZycgfV07XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignR2l0SHViIG9wZXJhdGlvbiBlcnJvcjonLCBlKTtcbiAgICAgICAgc2VjdGlvbnMuZ2l0aHViID0geyBzdGF0dXM6ICdlcnJvcicsIG1lc3NhZ2U6ICdHaXRIdWIgc2VydmljZSB1bmF2YWlsYWJsZScgfTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgICAgXG4gICAgY2FzZSAnaGVhbHRoJzpcbiAgICAgIC8vIENoZWNrIHNlcnZpY2UgaGVhbHRoXG4gICAgICBjb25zdCBoZWFsdGhDaGVja3MgPSBhd2FpdCBjaGVja1NlcnZpY2VIZWFsdGgoKTtcbiAgICAgIHNlY3Rpb25zLmFjdGlvbnMgPSBbeyB0eXBlOiAnaGVhbHRoLmNoZWNrZWQnLCBzZXJ2aWNlczogaGVhbHRoQ2hlY2tzLmxlbmd0aCB9XTtcbiAgICAgIHNlY3Rpb25zLnN1bW1hcnkgPSBgJHtoZWFsdGhDaGVja3MuZmlsdGVyKGggPT4gaC5zdGF0dXMgPT09ICdoZWFsdGh5JykubGVuZ3RofS8ke2hlYWx0aENoZWNrcy5sZW5ndGh9IHNlcnZpY2VzIGhlYWx0aHlgO1xuICAgICAgYnJlYWs7XG4gICAgICBcbiAgICBkZWZhdWx0OlxuICAgICAgLy8gR2VuZXJhbCByZXNwb25zZVxuICAgICAgc2VjdGlvbnMuc3VtbWFyeSA9ICdQcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4uLic7XG4gIH1cbiAgXG4gIHJldHVybiBzZWN0aW9ucztcbn1cblxuLy8gQ2hlY2sgcmVhbCBzZXJ2aWNlIGhlYWx0aFxuYXN5bmMgZnVuY3Rpb24gY2hlY2tTZXJ2aWNlSGVhbHRoKCkge1xuICBjb25zdCBzZXJ2aWNlcyA9IFtcbiAgICB7IG5hbWU6ICd1bmlmaWVkLXN3YXJtJywgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTAwL2hlYWx0aCcgfSxcbiAgICB7IG5hbWU6ICdtY3AtY29udGV4dCcsIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9oZWFsdGh6JyB9LFxuICAgIHsgbmFtZTogJ21jcC1naXRodWInLCB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgwODIvaGVhbHRoJyB9LFxuICAgIHsgbmFtZTogJ21jcC1yZXNlYXJjaCcsIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4NS9oZWFsdGgnIH0sXG4gIF07XG4gIFxuICBjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgc2VydmljZXMubWFwKGFzeW5jIChzZXJ2aWNlKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChzZXJ2aWNlLnVybCwgeyBzaWduYWw6IEFib3J0U2lnbmFsLnRpbWVvdXQoMTAwMCkgfSk7XG4gICAgICAgIHJldHVybiB7IC4uLnNlcnZpY2UsIHN0YXR1czogcmVzLm9rID8gJ2hlYWx0aHknIDogJ3VuaGVhbHRoeScsIGxhdGVuY3k6IDAgfTtcbiAgICAgIH0gY2F0Y2gge1xuICAgICAgICByZXR1cm4geyAuLi5zZXJ2aWNlLCBzdGF0dXM6ICdkZWFkJywgbGF0ZW5jeTogLTEgfTtcbiAgICAgIH1cbiAgICB9KVxuICApO1xuICBcbiAgcmV0dXJuIHJlc3VsdHM7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgY29uc3QgbWVzc2FnZXMgPSBib2R5Lm1lc3NhZ2VzIHx8IFt7IGNvbnRlbnQ6IGJvZHkubWVzc2FnZSB8fCAnJyB9XTtcbiAgICBjb25zdCBtZXNzYWdlID0gbWVzc2FnZXNbbWVzc2FnZXMubGVuZ3RoIC0gMV0/LmNvbnRlbnQgfHwgJyc7XG4gICAgY29uc3QgY29udGV4dCA9IGJvZHkuY29udGV4dCB8fCB7fTtcbiAgICBcbiAgICAvLyBEZXRlY3QgaW50ZW50IGZyb20gbWVzc2FnZVxuICAgIGNvbnN0IGludGVudCA9IGRldGVjdEludGVudChtZXNzYWdlKTtcbiAgICBcbiAgICAvLyBSb3V0ZSB0byBhcHByb3ByaWF0ZSBzZXJ2aWNlXG4gICAgY29uc3Qgc2VjdGlvbnMgPSBhd2FpdCByb3V0ZVRvU2VydmljZShpbnRlbnQsIG1lc3NhZ2UsIGNvbnRleHQpO1xuICAgIFxuICAgIC8vIEJ1aWxkIHVuaWZpZWQgcmVzcG9uc2Ugd2l0aCBzZWN0aW9ucyBmb3JtYXQgZXhwZWN0ZWQgYnkgYXVkaXRcbiAgICBjb25zdCByZXNwb25zZSA9IHtcbiAgICAgIHNlY3Rpb25zOiB7XG4gICAgICAgIHN1bW1hcnk6IHNlY3Rpb25zLnN1bW1hcnkgfHwgYEknbSBwcm9jZXNzaW5nIHlvdXIgJHtpbnRlbnR9IHJlcXVlc3QuLi5gLFxuICAgICAgICBhY3Rpb25zOiBzZWN0aW9ucy5hY3Rpb25zIHx8IFtdLFxuICAgICAgICByZXNlYXJjaDogc2VjdGlvbnMucmVzZWFyY2ggfHwgW10sXG4gICAgICAgIHBsYW5zOiBzZWN0aW9ucy5wbGFucyB8fCBudWxsLFxuICAgICAgICBjb2RlOiBzZWN0aW9ucy5jb2RlIHx8IG51bGwsXG4gICAgICAgIGdpdGh1Yjogc2VjdGlvbnMuZ2l0aHViIHx8IG51bGwsXG4gICAgICAgIGV2ZW50czogc2VjdGlvbnMuZXZlbnRzIHx8IFtdXG4gICAgICB9LFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgaW50ZW50LFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgc2Vzc2lvbklkOiBjb250ZXh0Py5zZXNzaW9uSWQgfHwgYHNlc3Npb25fJHtEYXRlLm5vdygpfWBcbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXNwb25zZSk7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQ2hhdCBBUEkgRXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzZWN0aW9uczoge1xuICAgICAgICBzdW1tYXJ5OiAnRXJyb3IgcHJvY2Vzc2luZyByZXF1ZXN0JyxcbiAgICAgICAgYWN0aW9uczogW10sXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgfVxuICAgIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJkZXRlY3RJbnRlbnQiLCJtZXNzYWdlIiwibXNnIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsInJvdXRlVG9TZXJ2aWNlIiwiaW50ZW50IiwiY29udGV4dCIsInNlY3Rpb25zIiwicmVzZWFyY2hIYW5kbGVkIiwibWNwUmVzIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJxdWVyeSIsInNpZ25hbCIsIkFib3J0U2lnbmFsIiwidGltZW91dCIsIm9rIiwiZGF0YSIsImpzb24iLCJyZXNlYXJjaCIsInJlc3VsdHMiLCJzdGF0dXMiLCJhY3Rpb25zIiwidHlwZSIsImUiLCJjb25zb2xlIiwibG9nIiwicmVzIiwic3dhcm1fdHlwZSIsInRhc2siLCJlbmFibGVfd2Vic29ja2V0Iiwic3dhcm1faWQiLCJlcnJvciIsImRpcmVjdFJlcyIsImFnZW50X3R5cGUiLCJyZXNwb25zZSIsInRhc2tfaWQiLCJhZ2VudEhhbmRsZWQiLCJleGVjdXRvclJlcyIsImNvbmZpZyIsImVuYWJsZV9tZW1vcnkiLCJtb2RlbHMiLCJldmVudHMiLCJpZCIsImFnZW50cyIsInBsYW5zIiwiY291bnQiLCJjb2RlIiwibGFuZ3VhZ2UiLCJzdHJhdGVneVJlcyIsInN0cmF0ZWd5IiwicmVzZWFyY2hSZXMiLCJwbGFuUmVzIiwiY29kZVJlcyIsInBsYW4iLCJzdGFnZXMiLCJzdW1tYXJ5IiwiaXNDb21taXQiLCJpc1BSIiwiaXNQdXNoIiwiZ2l0aHViUmVzIiwib3BlcmF0aW9uIiwiZ2l0aHViIiwicmVzdWx0IiwiaGVhbHRoQ2hlY2tzIiwiY2hlY2tTZXJ2aWNlSGVhbHRoIiwic2VydmljZXMiLCJsZW5ndGgiLCJmaWx0ZXIiLCJoIiwibmFtZSIsInVybCIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJzZXJ2aWNlIiwibGF0ZW5jeSIsIlBPU1QiLCJyZXF1ZXN0IiwibWVzc2FnZXMiLCJjb250ZW50IiwibWV0YWRhdGEiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzZXNzaW9uSWQiLCJub3ciLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/chat/unified-route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();