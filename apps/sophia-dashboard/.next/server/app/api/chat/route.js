"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/../../node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/../../node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/../../node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_lynnmusil_sophia_ai_intel_1_apps_sophia_dashboard_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"/Users/lynnmusil/sophia-ai-intel-1/apps/sophia-dashboard/app/api/chat/route.ts\",\n    nextConfigOutput,\n    userland: _Users_lynnmusil_sophia_ai_intel_1_apps_sophia_dashboard_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vLi4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyLmpzP25hbWU9YXBwJTJGYXBpJTJGY2hhdCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGY2hhdCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmNoYXQlMkZyb3V0ZS50cyZhcHBEaXI9JTJGVXNlcnMlMkZseW5ubXVzaWwlMkZzb3BoaWEtYWktaW50ZWwtMSUyRmFwcHMlMkZzb3BoaWEtZGFzaGJvYXJkJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmx5bm5tdXNpbCUyRnNvcGhpYS1haS1pbnRlbC0xJTJGYXBwcyUyRnNvcGhpYS1kYXNoYm9hcmQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9c3RhbmRhbG9uZSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUM4QjtBQUMzRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NvcGhpYS1kYXNoYm9hcmQvPzY0MzAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2x5bm5tdXNpbC9zb3BoaWEtYWktaW50ZWwtMS9hcHBzL3NvcGhpYS1kYXNoYm9hcmQvYXBwL2FwaS9jaGF0L3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcInN0YW5kYWxvbmVcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2hhdC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2NoYXRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2NoYXQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvbHlubm11c2lsL3NvcGhpYS1haS1pbnRlbC0xL2FwcHMvc29waGlhLWRhc2hib2FyZC9hcHAvYXBpL2NoYXQvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2NoYXQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   HEAD: () => (/* binding */ HEAD),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/../../node_modules/next/dist/api/server.js\");\n/**\n * SOPHIA COMPLETE - One File, One Truth\n * Everything in one place. No bullshit.\n */ \n// API Provider Configuration\nconst API_KEYS = {\n    perplexity: process.env.PERPLEXITY_API_KEY || \"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\",\n    tavily: process.env.TAVILY_API_KEY || \"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\",\n    serper: process.env.SERPER_API_KEY || \"7b616d4bf53e98d9169e89c25d6f4bf4389a9ed5\",\n    openrouter: process.env.OPENROUTER_API_KEY || \"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\",\n    brave: process.env.BRAVE_API_KEY || \"BSApz0194z7SG6DplmVozl7ttFOi0Eo\",\n    openai: process.env.OPENAI_API_KEY,\n    anthropic: process.env.ANTHROPIC_API_KEY\n};\n// In-memory session storage (replace with Redis in production)\nconst sessions = new Map();\nclass SophiaCore {\n    /**\n   * Classify query intent and complexity\n   */ classifyQuery(query) {\n        const q = query.toLowerCase();\n        // Determine query type\n        let type = \"general\";\n        if (/\\b(code|github|repo|library|npm|pip|framework|api)\\b/i.test(q)) type = \"code\";\n        else if (/\\b(search|find|research|latest|news|current)\\b/.test(q)) type = \"research\";\n        else if (/\\b(who|what|when|where|why|how|explain)\\b/.test(q)) type = \"knowledge\";\n        else if (/\\b(build|create|implement|design|plan)\\b/.test(q)) type = \"planning\";\n        else if (/\\b(analyze|compare|evaluate|assess)\\b/.test(q)) type = \"analysis\";\n        // Determine complexity and whether to use enterprise orchestrator\n        let complexity = \"simple\";\n        let useEnterprise = false;\n        if (/\\b(strategic|critical|urgent|executive|business)\\b/.test(q)) {\n            complexity = \"critical\";\n            useEnterprise = true;\n        } else if (/\\b(complex|multi-step|detailed|comprehensive)\\b/.test(q)) {\n            complexity = \"complex\";\n            useEnterprise = true;\n        } else if (/\\b(analyze|evaluate|compare|investigate)\\b/.test(q)) {\n            complexity = \"moderate\";\n            useEnterprise = /\\b(business|finance|strategy|operations)\\b/.test(q);\n        }\n        return {\n            type,\n            complexity,\n            useEnterprise\n        };\n    }\n    /**\n   * Call Perplexity for research\n   */ async callPerplexity(query) {\n        if (!API_KEYS.perplexity) return null;\n        try {\n            const response = await fetch(\"https://api.perplexity.ai/chat/completions\", {\n                method: \"POST\",\n                headers: {\n                    \"Authorization\": `Bearer ${API_KEYS.perplexity}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    model: \"llama-3.1-sonar-small-128k-online\",\n                    messages: [\n                        {\n                            role: \"user\",\n                            content: query\n                        }\n                    ]\n                })\n            });\n            if (response.ok) {\n                const data = await response.json();\n                return data.choices?.[0]?.message?.content || null;\n            }\n        } catch (e) {\n            console.error(\"Perplexity error:\", e);\n        }\n        return null;\n    }\n    /**\n   * Call Tavily for web search\n   */ async callTavily(query) {\n        if (!API_KEYS.tavily) return null;\n        try {\n            const response = await fetch(\"https://api.tavily.com/search\", {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    api_key: API_KEYS.tavily,\n                    query: query,\n                    search_depth: \"advanced\",\n                    max_results: 3\n                })\n            });\n            if (response.ok) {\n                const data = await response.json();\n                if (data.answer || data.results) {\n                    let result = data.answer || \"\";\n                    if (data.results?.length) {\n                        result += \"\\n\\nSources:\\n\" + data.results.slice(0, 3).map((r)=>`- ${r.title}: ${r.url}`).join(\"\\n\");\n                    }\n                    return result;\n                }\n            }\n        } catch (e) {\n            console.error(\"Tavily error:\", e);\n        }\n        return null;\n    }\n    /**\n   * Call Serper for Google search\n   */ async callSerper(query) {\n        if (!API_KEYS.serper) return null;\n        try {\n            const response = await fetch(\"https://google.serper.dev/search\", {\n                method: \"POST\",\n                headers: {\n                    \"X-API-KEY\": API_KEYS.serper,\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    q: query,\n                    num: 5\n                })\n            });\n            if (response.ok) {\n                const data = await response.json();\n                if (data.organic?.length) {\n                    let result = \"Search Results:\\n\";\n                    data.organic.slice(0, 5).forEach((item)=>{\n                        result += `• ${item.title}\\n  ${item.snippet}\\n  ${item.link}\\n\\n`;\n                    });\n                    return result;\n                }\n            }\n        } catch (e) {\n            console.error(\"Serper error:\", e);\n        }\n        return null;\n    }\n    /**\n   * Call OpenRouter for LLM access\n   */ async callOpenRouter(query, model = \"anthropic/claude-3-haiku\") {\n        if (!API_KEYS.openrouter) return null;\n        try {\n            const response = await fetch(\"https://openrouter.ai/api/v1/chat/completions\", {\n                method: \"POST\",\n                headers: {\n                    \"Authorization\": `Bearer ${API_KEYS.openrouter}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    model: model,\n                    messages: [\n                        {\n                            role: \"user\",\n                            content: query\n                        }\n                    ]\n                })\n            });\n            if (response.ok) {\n                const data = await response.json();\n                return data.choices?.[0]?.message?.content || null;\n            }\n        } catch (e) {\n            console.error(\"OpenRouter error:\", e);\n        }\n        return null;\n    }\n    /**\n   * Call local MCP services\n   */ async callMCP(query, type) {\n        try {\n            // Try MCP Research for GitHub/code queries\n            if (type === \"code\" || /\\b(github|repository)\\b/i.test(query)) {\n                const response = await fetch(`http://localhost:8085/search/github?q=${encodeURIComponent(query)}&limit=3`);\n                if (response.ok) {\n                    const data = await response.json();\n                    if (data.results?.length) {\n                        return data.results.map((r)=>`📦 ${r.title}\\n  ${r.summary}\\n  ⭐ ${r.metadata?.stars || 0} | ${r.url}`).join(\"\\n\\n\");\n                    }\n                }\n            }\n            // Try general research\n            const researchResponse = await fetch(\"http://localhost:8085/research\", {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    query,\n                    max_results: 3\n                })\n            });\n            if (researchResponse.ok) {\n                const data = await researchResponse.json();\n                if (data.results?.length) {\n                    return data.results.map((r)=>`- ${r.title}: ${r.summary}`).join(\"\\n\");\n                }\n            }\n        } catch (e) {\n        // MCP not available\n        }\n        return null;\n    }\n    /**\n   * Call Enterprise Orchestrator for complex queries\n   */ async callEnterpriseOrchestrator(query, sessionId) {\n        try {\n            const response = await fetch(\"http://localhost:8300/orchestrate\", {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    message: query,\n                    session_id: sessionId,\n                    context: {},\n                    max_latency_ms: 5000,\n                    max_cost: 0.10\n                })\n            });\n            if (response.ok) {\n                const data = await response.json();\n                return `${data.response}\\n\\n📊 **Enterprise Intelligence**\\n• Model: ${data.metadata.model}\\n• Complexity: ${data.metadata.complexity}\\n• Domain: ${data.metadata.domain}`;\n            }\n        } catch (e) {\n            console.error(\"Enterprise orchestrator error:\", e);\n        }\n        return null;\n    }\n    /**\n   * Generate response using best available provider\n   */ async generateResponse(query, sessionId) {\n        const classification = this.classifyQuery(query);\n        let response = null;\n        let provider = \"none\";\n        // Use enterprise orchestrator for complex/business queries\n        if (classification.useEnterprise) {\n            response = await this.callEnterpriseOrchestrator(query, sessionId);\n            if (response) {\n                provider = \"enterprise-orchestrator\";\n                return {\n                    response,\n                    provider,\n                    metadata: {\n                        ...classification,\n                        sessionId,\n                        timestamp: new Date().toISOString()\n                    }\n                };\n            }\n        }\n        // Try providers based on query type\n        if (classification.type === \"research\" || classification.type === \"knowledge\") {\n            // Try Serper first for research (Google search)\n            response = await this.callSerper(query);\n            if (response) provider = \"serper\";\n            // Fallback to Perplexity\n            if (!response) {\n                response = await this.callPerplexity(query);\n                if (response) provider = \"perplexity\";\n            }\n            // Fallback to Tavily\n            if (!response) {\n                response = await this.callTavily(query);\n                if (response) provider = \"tavily\";\n            }\n        }\n        if (classification.type === \"code\") {\n            // Try MCP for code searches\n            response = await this.callMCP(query, \"code\");\n            if (response) provider = \"mcp-github\";\n            // Fallback to Tavily\n            if (!response) {\n                response = await this.callTavily(`${query} github repository`);\n                if (response) provider = \"tavily\";\n            }\n        }\n        // For other types or if above failed, try OpenRouter\n        if (!response && classification.type !== \"code\") {\n            response = await this.callOpenRouter(query);\n            if (response) provider = \"openrouter\";\n        }\n        // Final fallback to MCP\n        if (!response) {\n            response = await this.callMCP(query, \"general\");\n            if (response) provider = \"mcp-research\";\n        }\n        // Ultimate fallback\n        if (!response) {\n            response = this.getFallbackResponse(query, classification.type);\n            provider = \"fallback\";\n        }\n        return {\n            response,\n            provider,\n            metadata: {\n                ...classification,\n                sessionId,\n                timestamp: new Date().toISOString()\n            }\n        };\n    }\n    /**\n   * Fallback responses when no API available\n   */ getFallbackResponse(query, queryType) {\n        const responses = {\n            code: `I understand you're looking for code related to \"${query}\". Try searching GitHub directly or check npm/PyPI for packages.`,\n            research: `I'd research \"${query}\" for you, but external services are unavailable. Check recent sources directly.`,\n            knowledge: `Regarding \"${query}\": I can provide general information, though real-time data needs active APIs.`,\n            planning: `I'll help you plan \"${query}\" using architectural best practices and proven patterns.`,\n            analysis: `For analyzing \"${query}\", I'll use my built-in knowledge since external services are unavailable.`,\n            general: `Processing your request about \"${query}\". External services are limited but I'll do my best.`\n        };\n        return responses[queryType] || `I received: \"${query}\". How can I help you today?`;\n    }\n}\n// Initialize Sophia\nconst sophia = new SophiaCore();\n/**\n * Main chat endpoint\n */ async function POST(request) {\n    try {\n        const body = await request.json();\n        const { message, sessionId = \"default\", context = {} } = body;\n        if (!message) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Message required\"\n            }, {\n                status: 400\n            });\n        }\n        // Get or create session\n        if (!sessions.has(sessionId)) {\n            sessions.set(sessionId, []);\n        }\n        const conversation = sessions.get(sessionId);\n        // Add user message\n        conversation.push({\n            role: \"user\",\n            content: message,\n            timestamp: new Date().toISOString()\n        });\n        // Generate response\n        const result = await sophia.generateResponse(message, sessionId);\n        // Add assistant response\n        conversation.push({\n            role: \"assistant\",\n            content: result.response,\n            timestamp: new Date().toISOString(),\n            metadata: result.metadata\n        });\n        // Keep only last 20 messages per session\n        if (conversation.length > 20) {\n            conversation.splice(0, conversation.length - 20);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: result.response,\n            sessionId,\n            provider: result.provider,\n            metadata: result.metadata,\n            conversationLength: conversation.length\n        });\n    } catch (error) {\n        console.error(\"Chat error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * Get conversation history\n */ async function GET(request) {\n    const { searchParams } = new URL(request.url);\n    const sessionId = searchParams.get(\"sessionId\") || \"default\";\n    const conversation = sessions.get(sessionId) || [];\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        sessionId,\n        messages: conversation,\n        total: conversation.length\n    });\n}\n/**\n * Health check\n */ async function HEAD() {\n    return new Response(null, {\n        status: 200\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RyxJQUFJQyxJQUFJWCxRQUFReEMsR0FBRztJQUM1QyxNQUFNaUIsWUFBWWlDLGFBQWFMLEdBQUcsQ0FBQyxnQkFBZ0I7SUFFbkQsTUFBTUQsZUFBZXZGLFNBQVN3RixHQUFHLENBQUM1QixjQUFjLEVBQUU7SUFFbEQsT0FBTzlFLHFEQUFZQSxDQUFDMkMsSUFBSSxDQUFDO1FBQ3ZCbUM7UUFDQXhDLFVBQVVtRTtRQUNWUSxPQUFPUixhQUFhakQsTUFBTTtJQUM1QjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFlMEQ7SUFDcEIsT0FBTyxJQUFJQyxTQUFTLE1BQU07UUFBRWIsUUFBUTtJQUFJO0FBQzFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc29waGlhLWRhc2hib2FyZC8uL2FwcC9hcGkvY2hhdC9yb3V0ZS50cz9kZTQ2Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU09QSElBIENPTVBMRVRFIC0gT25lIEZpbGUsIE9uZSBUcnV0aFxuICogRXZlcnl0aGluZyBpbiBvbmUgcGxhY2UuIE5vIGJ1bGxzaGl0LlxuICovXG5cbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcblxuLy8gVHlwZXNcbmludGVyZmFjZSBNZXNzYWdlIHtcbiAgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJztcbiAgY29udGVudDogc3RyaW5nO1xuICB0aW1lc3RhbXA/OiBzdHJpbmc7XG4gIG1ldGFkYXRhPzogYW55O1xufVxuXG5pbnRlcmZhY2UgQ2hhdFJlcXVlc3Qge1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIHNlc3Npb25JZD86IHN0cmluZztcbiAgY29udGV4dD86IGFueTtcbn1cblxuLy8gQVBJIFByb3ZpZGVyIENvbmZpZ3VyYXRpb25cbmNvbnN0IEFQSV9LRVlTID0ge1xuICBwZXJwbGV4aXR5OiBwcm9jZXNzLmVudi5QRVJQTEVYSVRZX0FQSV9LRVkgfHwgJ3BwbHgtWGZwcWp4a0plQjNiejNIbWwwOUNJM09GN1NRWm1CUUhOV2xqdEtzNGVYaTVDc1ZOJyxcbiAgdGF2aWx5OiBwcm9jZXNzLmVudi5UQVZJTFlfQVBJX0tFWSB8fCAndHZseS1kZXYtZXFHZ1lCajBQNVd6bGNrbEZveUtDdWNoS2lBNncxblMnLFxuICBzZXJwZXI6IHByb2Nlc3MuZW52LlNFUlBFUl9BUElfS0VZIHx8ICc3YjYxNmQ0YmY1M2U5OGQ5MTY5ZTg5YzI1ZDZmNGJmNDM4OWE5ZWQ1JyxcbiAgb3BlbnJvdXRlcjogcHJvY2Vzcy5lbnYuT1BFTlJPVVRFUl9BUElfS0VZIHx8ICdzay1vci12MS0xZDA5MDBiMzJhZDRlNzQxMDI3YjhkMGY2MzQ5MWNiZGFjZjgyNGNhNWRkMDY4OGQzOWNiODZjZGYyMzMyZTFmJyxcbiAgYnJhdmU6IHByb2Nlc3MuZW52LkJSQVZFX0FQSV9LRVkgfHwgJ0JTQXB6MDE5NHo3U0c2RHBsbVZvemw3dHRGT2kwRW8nLFxuICBvcGVuYWk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZLFxuICBhbnRocm9waWM6IHByb2Nlc3MuZW52LkFOVEhST1BJQ19BUElfS0VZLFxufTtcblxuLy8gSW4tbWVtb3J5IHNlc3Npb24gc3RvcmFnZSAocmVwbGFjZSB3aXRoIFJlZGlzIGluIHByb2R1Y3Rpb24pXG5jb25zdCBzZXNzaW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBNZXNzYWdlW10+KCk7XG5cbmNsYXNzIFNvcGhpYUNvcmUge1xuICAvKipcbiAgICogQ2xhc3NpZnkgcXVlcnkgaW50ZW50IGFuZCBjb21wbGV4aXR5XG4gICAqL1xuICBwcml2YXRlIGNsYXNzaWZ5UXVlcnkocXVlcnk6IHN0cmluZyk6IHsgdHlwZTogc3RyaW5nOyBjb21wbGV4aXR5OiBzdHJpbmc7IHVzZUVudGVycHJpc2U6IGJvb2xlYW4gfSB7XG4gICAgY29uc3QgcSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgXG4gICAgLy8gRGV0ZXJtaW5lIHF1ZXJ5IHR5cGVcbiAgICBsZXQgdHlwZSA9ICdnZW5lcmFsJztcbiAgICBpZiAoL1xcYihjb2RlfGdpdGh1YnxyZXBvfGxpYnJhcnl8bnBtfHBpcHxmcmFtZXdvcmt8YXBpKVxcYi9pLnRlc3QocSkpIHR5cGUgPSAnY29kZSc7XG4gICAgZWxzZSBpZiAoL1xcYihzZWFyY2h8ZmluZHxyZXNlYXJjaHxsYXRlc3R8bmV3c3xjdXJyZW50KVxcYi8udGVzdChxKSkgdHlwZSA9ICdyZXNlYXJjaCc7XG4gICAgZWxzZSBpZiAoL1xcYih3aG98d2hhdHx3aGVufHdoZXJlfHdoeXxob3d8ZXhwbGFpbilcXGIvLnRlc3QocSkpIHR5cGUgPSAna25vd2xlZGdlJztcbiAgICBlbHNlIGlmICgvXFxiKGJ1aWxkfGNyZWF0ZXxpbXBsZW1lbnR8ZGVzaWdufHBsYW4pXFxiLy50ZXN0KHEpKSB0eXBlID0gJ3BsYW5uaW5nJztcbiAgICBlbHNlIGlmICgvXFxiKGFuYWx5emV8Y29tcGFyZXxldmFsdWF0ZXxhc3Nlc3MpXFxiLy50ZXN0KHEpKSB0eXBlID0gJ2FuYWx5c2lzJztcbiAgICBcbiAgICAvLyBEZXRlcm1pbmUgY29tcGxleGl0eSBhbmQgd2hldGhlciB0byB1c2UgZW50ZXJwcmlzZSBvcmNoZXN0cmF0b3JcbiAgICBsZXQgY29tcGxleGl0eSA9ICdzaW1wbGUnO1xuICAgIGxldCB1c2VFbnRlcnByaXNlID0gZmFsc2U7XG4gICAgXG4gICAgaWYgKC9cXGIoc3RyYXRlZ2ljfGNyaXRpY2FsfHVyZ2VudHxleGVjdXRpdmV8YnVzaW5lc3MpXFxiLy50ZXN0KHEpKSB7XG4gICAgICBjb21wbGV4aXR5ID0gJ2NyaXRpY2FsJztcbiAgICAgIHVzZUVudGVycHJpc2UgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAoL1xcYihjb21wbGV4fG11bHRpLXN0ZXB8ZGV0YWlsZWR8Y29tcHJlaGVuc2l2ZSlcXGIvLnRlc3QocSkpIHtcbiAgICAgIGNvbXBsZXhpdHkgPSAnY29tcGxleCc7XG4gICAgICB1c2VFbnRlcnByaXNlID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKC9cXGIoYW5hbHl6ZXxldmFsdWF0ZXxjb21wYXJlfGludmVzdGlnYXRlKVxcYi8udGVzdChxKSkge1xuICAgICAgY29tcGxleGl0eSA9ICdtb2RlcmF0ZSc7XG4gICAgICB1c2VFbnRlcnByaXNlID0gL1xcYihidXNpbmVzc3xmaW5hbmNlfHN0cmF0ZWd5fG9wZXJhdGlvbnMpXFxiLy50ZXN0KHEpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4geyB0eXBlLCBjb21wbGV4aXR5LCB1c2VFbnRlcnByaXNlIH07XG4gIH1cblxuICAvKipcbiAgICogQ2FsbCBQZXJwbGV4aXR5IGZvciByZXNlYXJjaFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjYWxsUGVycGxleGl0eShxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgaWYgKCFBUElfS0VZUy5wZXJwbGV4aXR5KSByZXR1cm4gbnVsbDtcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkucGVycGxleGl0eS5haS9jaGF0L2NvbXBsZXRpb25zJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke0FQSV9LRVlTLnBlcnBsZXhpdHl9YCxcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBtb2RlbDogJ2xsYW1hLTMuMS1zb25hci1zbWFsbC0xMjhrLW9ubGluZScsXG4gICAgICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcXVlcnkgfV1cbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgcmV0dXJuIGRhdGEuY2hvaWNlcz8uWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8IG51bGw7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcignUGVycGxleGl0eSBlcnJvcjonLCBlKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbCBUYXZpbHkgZm9yIHdlYiBzZWFyY2hcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgY2FsbFRhdmlseShxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgaWYgKCFBUElfS0VZUy50YXZpbHkpIHJldHVybiBudWxsO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS50YXZpbHkuY29tL3NlYXJjaCcsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgYXBpX2tleTogQVBJX0tFWVMudGF2aWx5LFxuICAgICAgICAgIHF1ZXJ5OiBxdWVyeSxcbiAgICAgICAgICBzZWFyY2hfZGVwdGg6ICdhZHZhbmNlZCcsXG4gICAgICAgICAgbWF4X3Jlc3VsdHM6IDNcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgaWYgKGRhdGEuYW5zd2VyIHx8IGRhdGEucmVzdWx0cykge1xuICAgICAgICAgIGxldCByZXN1bHQgPSBkYXRhLmFuc3dlciB8fCAnJztcbiAgICAgICAgICBpZiAoZGF0YS5yZXN1bHRzPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSAnXFxuXFxuU291cmNlczpcXG4nICsgZGF0YS5yZXN1bHRzLnNsaWNlKDAsIDMpLm1hcCgocjogYW55KSA9PiBcbiAgICAgICAgICAgICAgYC0gJHtyLnRpdGxlfTogJHtyLnVybH1gXG4gICAgICAgICAgICApLmpvaW4oJ1xcbicpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcignVGF2aWx5IGVycm9yOicsIGUpO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsIFNlcnBlciBmb3IgR29vZ2xlIHNlYXJjaFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjYWxsU2VycGVyKHF1ZXJ5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICBpZiAoIUFQSV9LRVlTLnNlcnBlcikgcmV0dXJuIG51bGw7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vZ29vZ2xlLnNlcnBlci5kZXYvc2VhcmNoJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdYLUFQSS1LRVknOiBBUElfS0VZUy5zZXJwZXIsXG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgcTogcXVlcnksXG4gICAgICAgICAgbnVtOiA1XG4gICAgICAgIH0pXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGlmIChkYXRhLm9yZ2FuaWM/Lmxlbmd0aCkge1xuICAgICAgICAgIGxldCByZXN1bHQgPSAnU2VhcmNoIFJlc3VsdHM6XFxuJztcbiAgICAgICAgICBkYXRhLm9yZ2FuaWMuc2xpY2UoMCwgNSkuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7XG4gICAgICAgICAgICByZXN1bHQgKz0gYOKAoiAke2l0ZW0udGl0bGV9XFxuICAke2l0ZW0uc25pcHBldH1cXG4gICR7aXRlbS5saW5rfVxcblxcbmA7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1NlcnBlciBlcnJvcjonLCBlKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbCBPcGVuUm91dGVyIGZvciBMTE0gYWNjZXNzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNhbGxPcGVuUm91dGVyKHF1ZXJ5OiBzdHJpbmcsIG1vZGVsID0gJ2FudGhyb3BpYy9jbGF1ZGUtMy1oYWlrdScpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICBpZiAoIUFQSV9LRVlTLm9wZW5yb3V0ZXIpIHJldHVybiBudWxsO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL29wZW5yb3V0ZXIuYWkvYXBpL3YxL2NoYXQvY29tcGxldGlvbnMnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7QVBJX0tFWVMub3BlbnJvdXRlcn1gLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIG1vZGVsOiBtb2RlbCxcbiAgICAgICAgICBtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBxdWVyeSB9XVxuICAgICAgICB9KVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICByZXR1cm4gZGF0YS5jaG9pY2VzPy5bMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgbnVsbDtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdPcGVuUm91dGVyIGVycm9yOicsIGUpO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsIGxvY2FsIE1DUCBzZXJ2aWNlc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjYWxsTUNQKHF1ZXJ5OiBzdHJpbmcsIHR5cGU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBUcnkgTUNQIFJlc2VhcmNoIGZvciBHaXRIdWIvY29kZSBxdWVyaWVzXG4gICAgICBpZiAodHlwZSA9PT0gJ2NvZGUnIHx8IC9cXGIoZ2l0aHVifHJlcG9zaXRvcnkpXFxiL2kudGVzdChxdWVyeSkpIHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cDovL2xvY2FsaG9zdDo4MDg1L3NlYXJjaC9naXRodWI/cT0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSl9JmxpbWl0PTNgKTtcbiAgICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICBpZiAoZGF0YS5yZXN1bHRzPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLnJlc3VsdHMubWFwKChyOiBhbnkpID0+IFxuICAgICAgICAgICAgICBg8J+TpiAke3IudGl0bGV9XFxuICAke3Iuc3VtbWFyeX1cXG4gIOKtkCAke3IubWV0YWRhdGE/LnN0YXJzIHx8IDB9IHwgJHtyLnVybH1gXG4gICAgICAgICAgICApLmpvaW4oJ1xcblxcbicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBUcnkgZ2VuZXJhbCByZXNlYXJjaFxuICAgICAgY29uc3QgcmVzZWFyY2hSZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjgwODUvcmVzZWFyY2gnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBxdWVyeSwgbWF4X3Jlc3VsdHM6IDMgfSlcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAocmVzZWFyY2hSZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzZWFyY2hSZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGlmIChkYXRhLnJlc3VsdHM/Lmxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiBkYXRhLnJlc3VsdHMubWFwKChyOiBhbnkpID0+IGAtICR7ci50aXRsZX06ICR7ci5zdW1tYXJ5fWApLmpvaW4oJ1xcbicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gTUNQIG5vdCBhdmFpbGFibGVcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbCBFbnRlcnByaXNlIE9yY2hlc3RyYXRvciBmb3IgY29tcGxleCBxdWVyaWVzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNhbGxFbnRlcnByaXNlT3JjaGVzdHJhdG9yKHF1ZXJ5OiBzdHJpbmcsIHNlc3Npb25JZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHA6Ly9sb2NhbGhvc3Q6ODMwMC9vcmNoZXN0cmF0ZScsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgbWVzc2FnZTogcXVlcnksXG4gICAgICAgICAgc2Vzc2lvbl9pZDogc2Vzc2lvbklkLFxuICAgICAgICAgIGNvbnRleHQ6IHt9LFxuICAgICAgICAgIG1heF9sYXRlbmN5X21zOiA1MDAwLFxuICAgICAgICAgIG1heF9jb3N0OiAwLjEwXG4gICAgICAgIH0pXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIHJldHVybiBgJHtkYXRhLnJlc3BvbnNlfVxcblxcbvCfk4ogKipFbnRlcnByaXNlIEludGVsbGlnZW5jZSoqXFxu4oCiIE1vZGVsOiAke2RhdGEubWV0YWRhdGEubW9kZWx9XFxu4oCiIENvbXBsZXhpdHk6ICR7ZGF0YS5tZXRhZGF0YS5jb21wbGV4aXR5fVxcbuKAoiBEb21haW46ICR7ZGF0YS5tZXRhZGF0YS5kb21haW59YDtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFbnRlcnByaXNlIG9yY2hlc3RyYXRvciBlcnJvcjonLCBlKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgcmVzcG9uc2UgdXNpbmcgYmVzdCBhdmFpbGFibGUgcHJvdmlkZXJcbiAgICovXG4gIGFzeW5jIGdlbmVyYXRlUmVzcG9uc2UocXVlcnk6IHN0cmluZywgc2Vzc2lvbklkOiBzdHJpbmcpOiBQcm9taXNlPHtcbiAgICByZXNwb25zZTogc3RyaW5nO1xuICAgIHByb3ZpZGVyOiBzdHJpbmc7XG4gICAgbWV0YWRhdGE6IGFueTtcbiAgfT4ge1xuICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uID0gdGhpcy5jbGFzc2lmeVF1ZXJ5KHF1ZXJ5KTtcbiAgICBsZXQgcmVzcG9uc2UgPSBudWxsO1xuICAgIGxldCBwcm92aWRlciA9ICdub25lJztcbiAgICBcbiAgICAvLyBVc2UgZW50ZXJwcmlzZSBvcmNoZXN0cmF0b3IgZm9yIGNvbXBsZXgvYnVzaW5lc3MgcXVlcmllc1xuICAgIGlmIChjbGFzc2lmaWNhdGlvbi51c2VFbnRlcnByaXNlKSB7XG4gICAgICByZXNwb25zZSA9IGF3YWl0IHRoaXMuY2FsbEVudGVycHJpc2VPcmNoZXN0cmF0b3IocXVlcnksIHNlc3Npb25JZCk7XG4gICAgICBpZiAocmVzcG9uc2UpIHtcbiAgICAgICAgcHJvdmlkZXIgPSAnZW50ZXJwcmlzZS1vcmNoZXN0cmF0b3InO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgIHByb3ZpZGVyLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAuLi5jbGFzc2lmaWNhdGlvbixcbiAgICAgICAgICAgIHNlc3Npb25JZCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBUcnkgcHJvdmlkZXJzIGJhc2VkIG9uIHF1ZXJ5IHR5cGVcbiAgICBpZiAoY2xhc3NpZmljYXRpb24udHlwZSA9PT0gJ3Jlc2VhcmNoJyB8fCBjbGFzc2lmaWNhdGlvbi50eXBlID09PSAna25vd2xlZGdlJykge1xuICAgICAgLy8gVHJ5IFNlcnBlciBmaXJzdCBmb3IgcmVzZWFyY2ggKEdvb2dsZSBzZWFyY2gpXG4gICAgICByZXNwb25zZSA9IGF3YWl0IHRoaXMuY2FsbFNlcnBlcihxdWVyeSk7XG4gICAgICBpZiAocmVzcG9uc2UpIHByb3ZpZGVyID0gJ3NlcnBlcic7XG4gICAgICBcbiAgICAgIC8vIEZhbGxiYWNrIHRvIFBlcnBsZXhpdHlcbiAgICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNhbGxQZXJwbGV4aXR5KHF1ZXJ5KTtcbiAgICAgICAgaWYgKHJlc3BvbnNlKSBwcm92aWRlciA9ICdwZXJwbGV4aXR5JztcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gRmFsbGJhY2sgdG8gVGF2aWx5XG4gICAgICBpZiAoIXJlc3BvbnNlKSB7XG4gICAgICAgIHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jYWxsVGF2aWx5KHF1ZXJ5KTtcbiAgICAgICAgaWYgKHJlc3BvbnNlKSBwcm92aWRlciA9ICd0YXZpbHknO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBpZiAoY2xhc3NpZmljYXRpb24udHlwZSA9PT0gJ2NvZGUnKSB7XG4gICAgICAvLyBUcnkgTUNQIGZvciBjb2RlIHNlYXJjaGVzXG4gICAgICByZXNwb25zZSA9IGF3YWl0IHRoaXMuY2FsbE1DUChxdWVyeSwgJ2NvZGUnKTtcbiAgICAgIGlmIChyZXNwb25zZSkgcHJvdmlkZXIgPSAnbWNwLWdpdGh1Yic7XG4gICAgICBcbiAgICAgIC8vIEZhbGxiYWNrIHRvIFRhdmlseVxuICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICByZXNwb25zZSA9IGF3YWl0IHRoaXMuY2FsbFRhdmlseShgJHtxdWVyeX0gZ2l0aHViIHJlcG9zaXRvcnlgKTtcbiAgICAgICAgaWYgKHJlc3BvbnNlKSBwcm92aWRlciA9ICd0YXZpbHknO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBGb3Igb3RoZXIgdHlwZXMgb3IgaWYgYWJvdmUgZmFpbGVkLCB0cnkgT3BlblJvdXRlclxuICAgIGlmICghcmVzcG9uc2UgJiYgY2xhc3NpZmljYXRpb24udHlwZSAhPT0gJ2NvZGUnKSB7XG4gICAgICByZXNwb25zZSA9IGF3YWl0IHRoaXMuY2FsbE9wZW5Sb3V0ZXIocXVlcnkpO1xuICAgICAgaWYgKHJlc3BvbnNlKSBwcm92aWRlciA9ICdvcGVucm91dGVyJztcbiAgICB9XG4gICAgXG4gICAgLy8gRmluYWwgZmFsbGJhY2sgdG8gTUNQXG4gICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNhbGxNQ1AocXVlcnksICdnZW5lcmFsJyk7XG4gICAgICBpZiAocmVzcG9uc2UpIHByb3ZpZGVyID0gJ21jcC1yZXNlYXJjaCc7XG4gICAgfVxuICAgIFxuICAgIC8vIFVsdGltYXRlIGZhbGxiYWNrXG4gICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgcmVzcG9uc2UgPSB0aGlzLmdldEZhbGxiYWNrUmVzcG9uc2UocXVlcnksIGNsYXNzaWZpY2F0aW9uLnR5cGUpO1xuICAgICAgcHJvdmlkZXIgPSAnZmFsbGJhY2snO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgcmVzcG9uc2UsXG4gICAgICBwcm92aWRlcixcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIC4uLmNsYXNzaWZpY2F0aW9uLFxuICAgICAgICBzZXNzaW9uSWQsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGYWxsYmFjayByZXNwb25zZXMgd2hlbiBubyBBUEkgYXZhaWxhYmxlXG4gICAqL1xuICBwcml2YXRlIGdldEZhbGxiYWNrUmVzcG9uc2UocXVlcnk6IHN0cmluZywgcXVlcnlUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHJlc3BvbnNlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICAgIGNvZGU6IGBJIHVuZGVyc3RhbmQgeW91J3JlIGxvb2tpbmcgZm9yIGNvZGUgcmVsYXRlZCB0byBcIiR7cXVlcnl9XCIuIFRyeSBzZWFyY2hpbmcgR2l0SHViIGRpcmVjdGx5IG9yIGNoZWNrIG5wbS9QeVBJIGZvciBwYWNrYWdlcy5gLFxuICAgICAgcmVzZWFyY2g6IGBJJ2QgcmVzZWFyY2ggXCIke3F1ZXJ5fVwiIGZvciB5b3UsIGJ1dCBleHRlcm5hbCBzZXJ2aWNlcyBhcmUgdW5hdmFpbGFibGUuIENoZWNrIHJlY2VudCBzb3VyY2VzIGRpcmVjdGx5LmAsXG4gICAgICBrbm93bGVkZ2U6IGBSZWdhcmRpbmcgXCIke3F1ZXJ5fVwiOiBJIGNhbiBwcm92aWRlIGdlbmVyYWwgaW5mb3JtYXRpb24sIHRob3VnaCByZWFsLXRpbWUgZGF0YSBuZWVkcyBhY3RpdmUgQVBJcy5gLFxuICAgICAgcGxhbm5pbmc6IGBJJ2xsIGhlbHAgeW91IHBsYW4gXCIke3F1ZXJ5fVwiIHVzaW5nIGFyY2hpdGVjdHVyYWwgYmVzdCBwcmFjdGljZXMgYW5kIHByb3ZlbiBwYXR0ZXJucy5gLFxuICAgICAgYW5hbHlzaXM6IGBGb3IgYW5hbHl6aW5nIFwiJHtxdWVyeX1cIiwgSSdsbCB1c2UgbXkgYnVpbHQtaW4ga25vd2xlZGdlIHNpbmNlIGV4dGVybmFsIHNlcnZpY2VzIGFyZSB1bmF2YWlsYWJsZS5gLFxuICAgICAgZ2VuZXJhbDogYFByb2Nlc3NpbmcgeW91ciByZXF1ZXN0IGFib3V0IFwiJHtxdWVyeX1cIi4gRXh0ZXJuYWwgc2VydmljZXMgYXJlIGxpbWl0ZWQgYnV0IEknbGwgZG8gbXkgYmVzdC5gXG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4gcmVzcG9uc2VzW3F1ZXJ5VHlwZV0gfHwgYEkgcmVjZWl2ZWQ6IFwiJHtxdWVyeX1cIi4gSG93IGNhbiBJIGhlbHAgeW91IHRvZGF5P2A7XG4gIH1cbn1cblxuLy8gSW5pdGlhbGl6ZSBTb3BoaWFcbmNvbnN0IHNvcGhpYSA9IG5ldyBTb3BoaWFDb3JlKCk7XG5cbi8qKlxuICogTWFpbiBjaGF0IGVuZHBvaW50XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5OiBDaGF0UmVxdWVzdCA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHsgbWVzc2FnZSwgc2Vzc2lvbklkID0gJ2RlZmF1bHQnLCBjb250ZXh0ID0ge30gfSA9IGJvZHk7XG4gICAgXG4gICAgaWYgKCFtZXNzYWdlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdNZXNzYWdlIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIC8vIEdldCBvciBjcmVhdGUgc2Vzc2lvblxuICAgIGlmICghc2Vzc2lvbnMuaGFzKHNlc3Npb25JZCkpIHtcbiAgICAgIHNlc3Npb25zLnNldChzZXNzaW9uSWQsIFtdKTtcbiAgICB9XG4gICAgY29uc3QgY29udmVyc2F0aW9uID0gc2Vzc2lvbnMuZ2V0KHNlc3Npb25JZCkhO1xuICAgIFxuICAgIC8vIEFkZCB1c2VyIG1lc3NhZ2VcbiAgICBjb252ZXJzYXRpb24ucHVzaCh7XG4gICAgICByb2xlOiAndXNlcicsXG4gICAgICBjb250ZW50OiBtZXNzYWdlLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9KTtcbiAgICBcbiAgICAvLyBHZW5lcmF0ZSByZXNwb25zZVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNvcGhpYS5nZW5lcmF0ZVJlc3BvbnNlKG1lc3NhZ2UsIHNlc3Npb25JZCk7XG4gICAgXG4gICAgLy8gQWRkIGFzc2lzdGFudCByZXNwb25zZVxuICAgIGNvbnZlcnNhdGlvbi5wdXNoKHtcbiAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgY29udGVudDogcmVzdWx0LnJlc3BvbnNlLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBtZXRhZGF0YTogcmVzdWx0Lm1ldGFkYXRhXG4gICAgfSk7XG4gICAgXG4gICAgLy8gS2VlcCBvbmx5IGxhc3QgMjAgbWVzc2FnZXMgcGVyIHNlc3Npb25cbiAgICBpZiAoY29udmVyc2F0aW9uLmxlbmd0aCA+IDIwKSB7XG4gICAgICBjb252ZXJzYXRpb24uc3BsaWNlKDAsIGNvbnZlcnNhdGlvbi5sZW5ndGggLSAyMCk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBtZXNzYWdlOiByZXN1bHQucmVzcG9uc2UsXG4gICAgICBzZXNzaW9uSWQsXG4gICAgICBwcm92aWRlcjogcmVzdWx0LnByb3ZpZGVyLFxuICAgICAgbWV0YWRhdGE6IHJlc3VsdC5tZXRhZGF0YSxcbiAgICAgIGNvbnZlcnNhdGlvbkxlbmd0aDogY29udmVyc2F0aW9uLmxlbmd0aFxuICAgIH0pO1xuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0NoYXQgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbi8qKlxuICogR2V0IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogUmVxdWVzdCkge1xuICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gIGNvbnN0IHNlc3Npb25JZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ3Nlc3Npb25JZCcpIHx8ICdkZWZhdWx0JztcbiAgXG4gIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHNlc3Npb25zLmdldChzZXNzaW9uSWQpIHx8IFtdO1xuICBcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICBzZXNzaW9uSWQsXG4gICAgbWVzc2FnZXM6IGNvbnZlcnNhdGlvbixcbiAgICB0b3RhbDogY29udmVyc2F0aW9uLmxlbmd0aFxuICB9KTtcbn1cblxuLyoqXG4gKiBIZWFsdGggY2hlY2tcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEhFQUQoKSB7XG4gIHJldHVybiBuZXcgUmVzcG9uc2UobnVsbCwgeyBzdGF0dXM6IDIwMCB9KTtcbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiQVBJX0tFWVMiLCJwZXJwbGV4aXR5IiwicHJvY2VzcyIsImVudiIsIlBFUlBMRVhJVFlfQVBJX0tFWSIsInRhdmlseSIsIlRBVklMWV9BUElfS0VZIiwic2VycGVyIiwiU0VSUEVSX0FQSV9LRVkiLCJvcGVucm91dGVyIiwiT1BFTlJPVVRFUl9BUElfS0VZIiwiYnJhdmUiLCJCUkFWRV9BUElfS0VZIiwib3BlbmFpIiwiT1BFTkFJX0FQSV9LRVkiLCJhbnRocm9waWMiLCJBTlRIUk9QSUNfQVBJX0tFWSIsInNlc3Npb25zIiwiTWFwIiwiU29waGlhQ29yZSIsImNsYXNzaWZ5UXVlcnkiLCJxdWVyeSIsInEiLCJ0b0xvd2VyQ2FzZSIsInR5cGUiLCJ0ZXN0IiwiY29tcGxleGl0eSIsInVzZUVudGVycHJpc2UiLCJjYWxsUGVycGxleGl0eSIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJtb2RlbCIsIm1lc3NhZ2VzIiwicm9sZSIsImNvbnRlbnQiLCJvayIsImRhdGEiLCJqc29uIiwiY2hvaWNlcyIsIm1lc3NhZ2UiLCJlIiwiY29uc29sZSIsImVycm9yIiwiY2FsbFRhdmlseSIsImFwaV9rZXkiLCJzZWFyY2hfZGVwdGgiLCJtYXhfcmVzdWx0cyIsImFuc3dlciIsInJlc3VsdHMiLCJyZXN1bHQiLCJsZW5ndGgiLCJzbGljZSIsIm1hcCIsInIiLCJ0aXRsZSIsInVybCIsImpvaW4iLCJjYWxsU2VycGVyIiwibnVtIiwib3JnYW5pYyIsImZvckVhY2giLCJpdGVtIiwic25pcHBldCIsImxpbmsiLCJjYWxsT3BlblJvdXRlciIsImNhbGxNQ1AiLCJlbmNvZGVVUklDb21wb25lbnQiLCJzdW1tYXJ5IiwibWV0YWRhdGEiLCJzdGFycyIsInJlc2VhcmNoUmVzcG9uc2UiLCJjYWxsRW50ZXJwcmlzZU9yY2hlc3RyYXRvciIsInNlc3Npb25JZCIsInNlc3Npb25faWQiLCJjb250ZXh0IiwibWF4X2xhdGVuY3lfbXMiLCJtYXhfY29zdCIsImRvbWFpbiIsImdlbmVyYXRlUmVzcG9uc2UiLCJjbGFzc2lmaWNhdGlvbiIsInByb3ZpZGVyIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZ2V0RmFsbGJhY2tSZXNwb25zZSIsInF1ZXJ5VHlwZSIsInJlc3BvbnNlcyIsImNvZGUiLCJyZXNlYXJjaCIsImtub3dsZWRnZSIsInBsYW5uaW5nIiwiYW5hbHlzaXMiLCJnZW5lcmFsIiwic29waGlhIiwiUE9TVCIsInJlcXVlc3QiLCJzdGF0dXMiLCJoYXMiLCJzZXQiLCJjb252ZXJzYXRpb24iLCJnZXQiLCJwdXNoIiwic3BsaWNlIiwiY29udmVyc2F0aW9uTGVuZ3RoIiwiR0VUIiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidG90YWwiLCJIRUFEIiwiUmVzcG9uc2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flynnmusil%2Fsophia-ai-intel-1%2Fapps%2Fsophia-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();